# Source for Primodium System Interfaces

- [`/contract-source/src/codegen/world`](https://github.com/primodiumxyz/developer/blob/main/contract-source/src/codegen/world): Generated Solidity interfaces for each publicly-accessible system.

## Primodium Systems in World Extensions

The example [`building-upgrade-bounty`](../world-extension/examples.mdx) world extension requires a reference to functions in the Primodium `UpgradeBuildingSystem`, which handles building upgrades. The following steps demonstrate how to reference the `UpgradeBuildingSystem` in a world extension and successfully its function `upgradeBuilding()`.

First, copy the following folders to your Primodium extension project:

- [`/contract-source/src/codegen/world`](https://github.com/primodiumxyz/developer/blob/main/contract-source/src/codegen/world): contains references to all system interfaces.
- [`/contract-source/src/codegen/common.sol`](https://github.com/primodiumxyz/developer/blob/main/contract-source/src/codegen/common.sol): contains generated Solidity enums and structs for common types.

In the `building-upgrade-bounty` example, the above files are copied to [`/examples/building-upgrade-bounty/packages/contracts/src/primodium-codegen`](https://github.com/primodiumxyz/developer/blob/main/examples/building-upgrade-bounty/packages/contracts/src/primodium-codegen).

Locate the function you want to call in the generated system interfaces. In this case, we want to call the upgrade `upgradeBuilding()`, whose function signature is obtained from the generated `IUpgradeBuildingSystem`.

```solidity copy filename="/contract-source/src/codegen/world/IUpgradeBuildingSystem.sol" showLineNumbers {13}
// SPDX-License-Identifier: MIT
pragma solidity >=0.8.21;

/* Autogenerated file. Do not edit manually. */

import { PositionData } from "codegen/index.sol";

/**
 * @title IUpgradeBuildingSystem
 * @dev This interface is automatically generated from the corresponding system contract. Do not edit manually.
 */
interface IUpgradeBuildingSystem {
  function upgradeBuilding(PositionData memory coord) external returns (bytes32 buildingEntity);
}
```

The `upgradeBuilding()`function in `BuildSystem` can then be called as follows, with `UpgradeBuildingS` being the system ID of the Primodium `UpgradeBuildingSystem` cut off at 16 bytes. See [footguns](../world-extension/footguns.mdx) for more details.

```solidity copy filename="/examples/building-upgrade-bounty/packages/contracts/src/systems/UpgrBounSystem.sol" showLineNumbers {1,16-22}
import { IWorld as IPrimodiumWorld } from "../primodium-codegen/world/IWorld.sol";

contract UpgrBounSystem is System {
  /**
   * @dev Upgrades the building at the specified coordinate using the bounty published by the given address.
   * @param bountyPublisherAddress The address of the bounty publisher.
   * @param coord The coordinate of the building to upgrade.
   * @return newBuildingEntity The new building entity.
   */
  function upgradeForBounty(
    address bountyPublisherAddress,
    PositionData memory coord
  ) public returns (bytes memory newBuildingEntity) {
    // ...
    // Call the upgradeBuilding function from the World contract
    ResourceId upgradeBuildingSystemId = WorldResourceIdLib.encode(RESOURCE_SYSTEM, ROOT_NAMESPACE, "UpgradeBuildingS");

    newBuildingEntity = IPrimodiumWorld(_world()).callFrom(
      bountyPublisherAddress,
      upgradeBuildingSystemId,
      abi.encodeWithSignature("upgradeBuilding((int32,int32,bytes32))", (coord))
    );
    // ...
  }
}
```
